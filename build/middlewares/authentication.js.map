{"version":3,"sources":["../../middlewares/authentication.js"],"names":["dotenv","config","secret","process","env","SECRET_KEY","verifyToken","req","res","next","token","headers","authorization","jwt","verify","err","decoded","error","Error","status"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,UAA3B;AACA,IAAMC,cAAc,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtC,MAAMC,QAAQH,IAAII,OAAJ,CAAYC,aAA1B;;AAEAC,yBAAIC,MAAJ,CAAWJ,KAAX,EAAkBR,MAAlB,EAA0B,UAACa,GAAD,EAAMC,OAAN,EAAkB;AAC1C,QAAIC,cAAJ;AACA,QAAI,CAACP,KAAL,EAAY;AACVO,cAAQ,IAAIC,KAAJ,CAAU,mBAAV,CAAR;AACAD,YAAME,MAAN,GAAe,GAAf;AACA,aAAOV,KAAKQ,KAAL,CAAP;AACD;AACD,QAAIF,GAAJ,EAAS;AACPE,cAAQ,IAAIC,KAAJ,CAAU,eAAV,CAAR;AACAD,YAAME,MAAN,GAAe,GAAf;AACA,aAAOV,KAAKQ,KAAL,CAAP;AACD;;AAEDV,QAAIS,OAAJ,GAAcA,OAAd;AACA,WAAOP,MAAP;AACD,GAfD;AAgBD,CAnBD;;kBAqBeH,W","file":"authentication.js","sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\n\ndotenv.config();\nconst secret = process.env.SECRET_KEY;\nconst verifyToken = (req, res, next) => {\n  const token = req.headers.authorization;\n\n  jwt.verify(token, secret, (err, decoded) => {\n    let error;\n    if (!token) {\n      error = new Error('No token provided');\n      error.status = 400;\n      return next(error);\n    }\n    if (err) {\n      error = new Error('Invalid token');\n      error.status = 401;\n      return next(error);\n    }\n\n    req.decoded = decoded;\n    return next();\n  });\n};\n\nexport default verifyToken;\n"]}